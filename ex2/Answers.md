<style>
    body {
        direction: rtl;
        text-align: right;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    }
    h1, h2, h3, h4, h5, h6 {
        direction: rtl;
        text-align: right;
        border-bottom: none; /* Optional: Clean look for headers */
    }
    p, li, table {
        direction: rtl;
        text-align: right;
    }
    /* Fix bullet point indentation for RTL */
    ul, ol {
        margin-right: 20px;
        margin-left: 0;
        padding-right: 20px;
        padding-left: 0;
    }
    /* Keep math formulas LTR so they are readable */
    .katex, .math, code {
        direction: ltr;
        display: inline-block;
    }
</style>

# חלק 1

## שאלה 1
הסתברויות הפליטה של כל מטבע בכל מצב חבוי הן:

* F | H -> 0.49920445
* F | T -> 0.50079555
* L | H -> 0.92330427
* L | T -> 0.07669573

ההסתברויות שקיבלנו עבור מטבע הוגן הגיוניות, כיוון שהן מייצגות את העובדה שההסתברות לראות H שווה להסתברות לראות T.
המטבע המוטה מוטה בבירור לכיוון H, שכן ההסתברות לקבל H גבוהה משמעותית מההסתברות לקבל T.

## שאלה 2
הסתברויות המעבר של מטבע בין המצבים החבויים הן:

* F -> F: 0.90337949
* F -> L: 0.09662051
* L -> F: 0.22271111
* L -> L: 0.77728889

ההסתברויות שקיבלנו הגיוניות משום שהמעבר בין מצבים זהים הוא מאוד סביר, ועל כן קיבלנו הסתברות גבוהה לכך.
המעברים בין שני מצבים שונים פחות סבירים, ואכן קיבלנו עבורם הסתברויות יותר נמוכות.

## שאלה 3
![](plots/convergence_EM_Convergence.png)

הגרף שקיבלנו הגיוני, כיוון שניתן לראות באופן ברור כי:

1. הlikelihood עולה ככל שמספר האיטרציות גדל
2. בשלב מסוים (מהאיטרציה ה100 בערך) ניתן לראות שהפו' מתכנסת, והשינוי בlikelihood קטן מאוד

שתי התובנות הללו מתאימות בדיוק לתיאור האלגוריתם.

## שאלה 4
![](plots/convergence_max_iters.png)

שינינו את מס' האיטרציות המקסימלי להיות 250 איטרציות. בנוסף, הגדרנו tolerance של $1e-4$.
כפי שניתן לראות בגרף, הריצה נעצרה לאחר 219 איטרציות, כיוון שבאיטרציה האחרונה השינוי היה קטן מאותו tolerance שהגדרנו. כלומר, ככל שמס' האיטרציות המקסימלי עולה אכן הנראות משתפרת, אך בשלב מסוים היא משתפרת בקצב קטן מאוד.

## שאלה 5
![](plots/convergence_Transition_between_F_and_L_initialized_to_0.png)

אתחלנו את המעבר בין F ל - L במטריצת המעברים לאפס. כתוצאה מכך, לפי מה שלמדנו בכיתה, נצפה שבמטריצת המעברים הנלמדת המעבר הנ"ל יישאר 0.
לאחר ההרצה, המעבר אכן נשאר בהסתברות 0, כפי שציפינו. בנוסף, הבחנו כי הlikelihood המקסימלי שהושג באתחול זה, נמוך משמעותית מזה שהושג באתחול רנדומי. ברצפים שלנו, המעבר בין F ל - L הוא אפשרי, ולכן כאשר אנו מגדירים אותו ל - 0, בהכרח נקטין את הlikelihood שהאלגוריתם יכול להשיג.

![](plots/convergence_Emission_is_initialized_to_uniform_probabilities.png)

אתחלנו את מטריצת הפליטה בהסתברות אחידה (0.5 בכל הערכים). כתוצאה מכך, במטריצת הפליטה הנלמדת קיבלנו שבהינתן תצפית כלשהי, ההסתברות לקבל כל מצב חבוי זהה. כלומר, במקרה שלנו:
$P(F | H) = P(L | H), P(F | T) = P(L | T)$

בנוסף, הבחנו שגם במקרה הזה, הlikelihood מתכנס לערך קטן משמעותית מזה שהושג באחתול רנדומי.
כאן גם אפשר להבחין שהlikelihood מתכנס בצורה מהירה משמעותית (אחרי 17 איטרציות בגרף). זאת כיוון שבעקבות האתחול היוניפורמי, האלגוריתם ילמד רק את מספר הפעמים שהתצפית נראתה מתוך כל הרצף, וזוהי תהיה הסתברות הפליטה בכל המצבים עבור תצפית זו. זהו תהליך יותר פשוט, ולכן גם יותר מהיר.